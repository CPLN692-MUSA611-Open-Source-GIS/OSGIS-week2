<!DOCTYPE html>
<html>
  <head>
    <script src="health_centers_csv.js"></script>
  </head>
  <body>
    <!--left panel-->
    <div style="position:fixed;left:0px;width:400px">
    </div>
    <!--map-->
    <div id="map" style="position:fixed;right:0px;left:400px;height:100%;">
    </div>

    <!--javascript-->
    <script>
      /* =====================

      # Lab 2, Part 2 â€” Convert CSV to JSON

      ## Introduction

      Creating this week's homework assignment, it was necessary to convert the data stored in
      healthCentersCSV from its native format (CSV) to JSON. This is a difficult task partially because
      it is hard to think about all of the edge cases you might encounter and partially because
      datasets are so rarely 'clean'.

      Try your hand at a similar task:
      For each row in the 'CSV' (instead of separate lines, our 'CSV' is broken up by semicolons),
      console.log an array with all columns separated into different fields and all lines represented
      as separate arrays.

      For example, given the row "I'm,a,little,teapot", you will print out ["I'm", "a", "little", "teapot"].

      Hint 1: It might be useful to structure this data as an array of arrays or an array of objects.
      The outer array represents all the rows of our CSV, while each inner array or object represents
      one such row.

      Hint 2: Check out this method that all strings have (practice using it on small, simplified
      examples in your console!!!):
      https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split

      ===================== */

      /* =====================

      Start code

      ===================== */

      // feel free to comment this line out if it is too noisy in your console!
      //console.log(healthCentersCSV)


      //reference: https://stackoverflow.com/questions/27979002/convert-csv-data-into-json-format-using-javascript


    //var csv is the CSV file with headers
    function csvJSON(csv){

    var lines=csv.split(";");

    var result = [];

    // NOTE: If your columns contain commas in their values, you'll need
    // to deal with those before doing the next step 
    // (you might convert them to &&& or something, then covert them back later)
    // jsfiddle showing the issue https://jsfiddle.net/
    var headers=lines[0].split(",");

    for(var i=1;i<lines.length;i++){

        var obj = {};
        var currentline=lines[i].split(",");

        for(var j=0;j<headers.length;j++){
        obj[headers[j]] = currentline[j];
        }

    result.push(obj);

    }

//return result; //JavaScript object
return JSON.stringify(result); //JSON
}
    

var final = csvJSON(healthCentersCSV) 

  console.log(final)


      /* =====================

      End code

      ===================== */
    </script>
  </body>
</html>
